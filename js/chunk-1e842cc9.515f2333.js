(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e842cc9"],{"1d91":function(e,t,n){"use strict";var a=n("4862"),i=n.n(a);i.a},4862:function(e,t,n){var a=n("e0da");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("499e").default;i("1e57e7a0",a,!0,{sourceMap:!1,shadowMode:!1})},d0c4:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout__page"},[n("div",{staticClass:"layout__header"},[n("van-nav-bar",{attrs:{title:e.isEdit?"编辑任务":"新建任务","left-text":"返回","right-text":e.isEdit?"删除":"","left-arrow":""},on:{"click-left":e.handleClickLeft,"click-right":e.confirmDeleteNote}})],1),n("div",{staticClass:"layout__body"},[n("van-cell-group",[n("van-field",{attrs:{label:"任务名称",placeholder:"请输入任务名称",maxlength:"16",required:""},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name",t)},expression:"formModel.name"}}),n("van-cell",{attrs:{title:"截止时间",value:e.deadlineText,"is-link":""},on:{click:function(t){e.selectDeadlineShow=!0}}}),n("van-cell",{attrs:{title:"同步任务到手机日历"},on:{click:e.toggleSyncCalendar}},[n("van-checkbox",{attrs:{slot:"right-icon",disabled:!e.formModel.deadline},slot:"right-icon",model:{value:e.formModel.isSync,callback:function(t){e.$set(e.formModel,"isSync",t)},expression:"formModel.isSync"}})],1),n("van-field",{attrs:{label:"备注",type:"textarea",placeholder:"请输入备注",maxlength:"50"},model:{value:e.formModel.remark,callback:function(t){e.$set(e.formModel,"remark",t)},expression:"formModel.remark"}})],1),n("span",{staticClass:"note__create-form--metion extend-click",on:{click:e.handleMentionClick}},[e._v("每日名言（演示接口缓存效果）")]),n("div",{staticClass:"bottom-button--submit",attrs:{id:"fixed-bottom"}},[n("van-button",{attrs:{type:"primary",size:"large"},on:{click:e.handleCreateNote}},[e._v("提交")])],1)],1),n("van-popup",{attrs:{position:"bottom"},model:{value:e.selectDeadlineShow,callback:function(t){e.selectDeadlineShow=t},expression:"selectDeadlineShow"}},[n("van-datetime-picker",{attrs:{title:"选择截止时间",type:"datetime",formatter:e.dateTimePickerFormatter,"min-date":new Date},on:{cancel:function(t){e.selectDeadlineShow=!1},confirm:e.handleTimePickerConfirm},model:{value:e.formModel.deadline,callback:function(t){e.$set(e.formModel,"deadline",t)},expression:"formModel.deadline"}})],1)],1)},i=[],r=(n("7f7f"),n("96cf"),n("3b8d")),o=(n("47e2"),n("2241")),s=n("d225"),u=n("b0b4"),l=n("308d"),c=n("6bb5"),d=n("4e2b"),m=(n("da02"),n("6b41")),h=(n("c625"),n("b650")),f=(n("9eda"),n("565f")),p=(n("2a53"),n("34e9")),v=(n("3ec1"),n("7744")),b=(n("87d0"),n("e41f")),g=(n("3cd0"),n("f8c2"),n("c31d")),y=n("d282"),k=n("68ed"),x=n("482d"),w=n("90c6");function M(e,t){var n=-1,a=Array(e);while(++n<e)a[n]=t(n);return a}function D(e){if(e){while(Object(w["a"])(parseInt(e,10))){if(!(e.length>1))return;e=e.slice(1)}return parseInt(e,10)}}function O(e,t){return 32-new Date(e,t-1,32).getDate()}var j=n("1b10"),C=n("f253"),$=Object(g["a"])({},j["a"],{value:null,filter:Function,showToolbar:{type:Boolean,default:!0},formatter:{type:Function,default:function(e,t){return t}}}),V={data:function(){return{innerValue:this.formatValue(this.value)}},computed:{originColumns:function(){var e=this;return this.ranges.map((function(t){var n=t.type,a=t.range,i=M(a[1]-a[0]+1,(function(e){var t=Object(k["b"])(a[0]+e);return t}));return e.filter&&(i=e.filter(n,i)),{type:n,values:i}}))},columns:function(){var e=this;return this.originColumns.map((function(t){return{values:t.values.map((function(n){return e.formatter(t.type,n)}))}}))}},watch:{innerValue:function(e){this.$emit("input",e)},columns:function(){this.updateColumnValue(this.innerValue)}},mounted:function(){this.updateColumnValue(this.innerValue)},methods:{onConfirm:function(){this.$emit("confirm",this.innerValue)},onCancel:function(){this.$emit("cancel")}},render:function(){var e=this,t=arguments[0],n={};return Object.keys(j["a"]).forEach((function(t){n[t]=e[t]})),t(C["a"],{ref:"picker",attrs:{columns:this.columns},on:{change:this.onChange,confirm:this.onConfirm,cancel:this.onCancel},props:Object(g["a"])({},n)})}},N=Object(y["a"])("time-picker"),S=N[0],T=S({mixins:[V],props:Object(g["a"])({},$,{minHour:{type:Number,default:0},maxHour:{type:Number,default:23},minMinute:{type:Number,default:0},maxMinute:{type:Number,default:59}}),computed:{ranges:function(){return[{type:"hour",range:[this.minHour,this.maxHour]},{type:"minute",range:[this.minMinute,this.maxMinute]}]}},watch:{value:function(e){e=this.formatValue(e),e!==this.innerValue&&(this.innerValue=e,this.updateColumnValue(e))}},methods:{formatValue:function(e){e||(e=Object(k["b"])(this.minHour)+":"+Object(k["b"])(this.minMinute));var t=e.split(":"),n=t[0],a=t[1];return n=Object(k["b"])(Object(x["a"])(n,this.minHour,this.maxHour)),a=Object(k["b"])(Object(x["a"])(a,this.minMinute,this.maxMinute)),n+":"+a},onChange:function(e){var t=this,n=e.getIndexes(),a=this.originColumns[0].values[n[0]],i=this.originColumns[1].values[n[1]],r=a+":"+i;this.innerValue=this.formatValue(r),this.$nextTick((function(){t.$nextTick((function(){t.$emit("change",e)}))}))},updateColumnValue:function(e){var t=this,n=this.formatter,a=e.split(":"),i=[n("hour",a[0]),n("minute",a[1])];this.$nextTick((function(){t.$refs.picker.setValues(i)}))}}});function H(e){return"[object Date]"===Object.prototype.toString.call(e)&&!Object(w["a"])(e.getTime())}var Y=(new Date).getFullYear(),_=Object(y["a"])("date-picker"),I=_[0],F=I({mixins:[V],props:Object(g["a"])({},$,{type:{type:String,default:"datetime"},minDate:{type:Date,default:function(){return new Date(Y-10,0,1)},validator:H},maxDate:{type:Date,default:function(){return new Date(Y+10,11,31)},validator:H}}),watch:{value:function(e){e=this.formatValue(e),e.valueOf()!==this.innerValue.valueOf()&&(this.innerValue=e)}},computed:{ranges:function(){var e=this.getBoundary("max",this.innerValue),t=e.maxYear,n=e.maxDate,a=e.maxMonth,i=e.maxHour,r=e.maxMinute,o=this.getBoundary("min",this.innerValue),s=o.minYear,u=o.minDate,l=o.minMonth,c=o.minHour,d=o.minMinute,m=[{type:"year",range:[s,t]},{type:"month",range:[l,a]},{type:"day",range:[u,n]},{type:"hour",range:[c,i]},{type:"minute",range:[d,r]}];return"date"===this.type&&m.splice(3,2),"year-month"===this.type&&m.splice(2,3),m}},methods:{formatValue:function(e){return H(e)||(e=this.minDate),e=Math.max(e,this.minDate.getTime()),e=Math.min(e,this.maxDate.getTime()),new Date(e)},getBoundary:function(e,t){var n,a=this[e+"Date"],i=a.getFullYear(),r=1,o=1,s=0,u=0;return"max"===e&&(r=12,o=O(t.getFullYear(),t.getMonth()+1),s=23,u=59),t.getFullYear()===i&&(r=a.getMonth()+1,t.getMonth()+1===r&&(o=a.getDate(),t.getDate()===o&&(s=a.getHours(),t.getHours()===s&&(u=a.getMinutes())))),n={},n[e+"Year"]=i,n[e+"Month"]=r,n[e+"Date"]=o,n[e+"Hour"]=s,n[e+"Minute"]=u,n},onChange:function(e){var t,n=this,a=e.getIndexes(),i=function(e){return D(n.originColumns[e].values[a[e]])},r=i(0),o=i(1),s=O(r,o);t="year-month"===this.type?1:i(2),t=t>s?s:t;var u=0,l=0;"datetime"===this.type&&(u=i(3),l=i(4));var c=new Date(r,o-1,t,u,l);this.innerValue=this.formatValue(c),this.$nextTick((function(){n.$nextTick((function(){n.$emit("change",e)}))}))},updateColumnValue:function(e){var t=this,n=this.formatter,a=[n("year",""+e.getFullYear()),n("month",Object(k["b"])(e.getMonth()+1)),n("day",Object(k["b"])(e.getDate()))];"datetime"===this.type&&a.push(n("hour",Object(k["b"])(e.getHours())),n("minute",Object(k["b"])(e.getMinutes()))),"year-month"===this.type&&(a=a.slice(0,2)),this.$nextTick((function(){t.$refs.picker.setValues(a)}))}}}),E=Object(y["a"])("datetime-picker"),R=E[0],q=E[1],B=R({props:Object(g["a"])({},T.props,{},F.props),render:function(){var e=arguments[0],t="time"===this.type?T:F;return e(t,{class:q(),props:Object(g["a"])({},this.$props),on:Object(g["a"])({},this.$listeners)})}}),P=(n("9753"),n("417e")),z=n("9ab4"),J=n("60a3"),L=n("c32d"),A=n.n(L),G=n("75fb"),K=n("ecb3"),Q=n("2255");J["c"].use(m["a"]).use(h["a"]).use(f["a"]).use(p["a"]).use(v["a"]).use(b["a"]).use(B).use(P["a"]);var U=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(l["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.dateTimePickerFormatter=Q["b"],e.selectDeadlineShow=!1,e.formModel={id:Object(Q["a"])(20),name:"",deadline:void 0,isSync:!1,isDone:!1,remark:""},e.deadlineText="",e.rules={name:[{required:!0,message:"请填写任务名称"}]},e}return Object(d["a"])(t,e),Object(u["a"])(t,[{key:"handleClickLeft",value:function(){this.$router.go(-1)}},{key:"handleMentionClick",value:function(){this.$router.push({name:"quote"})}},{key:"handleTimePickerConfirm",value:function(){this.deadlineText=A()(this.formModel.deadline).format("YYYY-MM-DD HH:mm:ss"),this.selectDeadlineShow=!1}},{key:"toggleSyncCalendar",value:function(){if(!this.formModel.deadline)return this.$toast({message:"请先选择截止日期"});this.formModel.isSync=!this.formModel.isSync}},{key:"confirmDeleteNote",value:function(){var e=this;o["a"].alert({title:"删除确认",message:"是否删除该任务?"}).then((function(){e.handleDeleteNote(e.notebookId,e.id)}))}},{key:"handleDeleteNote",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K["a"].deleteNote(t,n);case 3:this.$router.go(-1),e.next=10;break;case 6:e.prev=6,e.t0=e["catch"](0),window.$sentry.log({error:e.t0,fileName:"/github/workspace/src/views/note/create/index.vue",lineNo:74,scope:"NoteCreate -> value -> _handleDeleteNote"}),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,6]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"handleCreateNote",value:function(){var e=this;this.validator.validate().then(Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=e.formModel,a=e.notebookId,i=e.isEdit,t.next=4,K["a"].saveNote(n,a,i);case 4:if(!n.isSync||!n.deadline){t.next=8;break}return r={id:n.id,title:n.name,deadline:n.deadline.getTime(),alarm:[5]},t.next=8,K["a"].syncCalendar(r,a);case 8:e.$router.go(-1),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),window.$sentry.log({error:t.t0,fileName:"/github/workspace/src/views/note/create/index.vue",lineNo:86,scope:"NoteCreate -> value"}),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))).catch((function(t){e.$toast(t[0].message)}))}},{key:"created",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.isEdit){e.next=12;break}return e.prev=1,e.next=4,K["a"].getNote(this.notebookId,this.id);case 4:t=e.sent,t&&(this.formModel={id:t.id,name:t.name,deadline:t.deadline,isDone:t.isDone,isSync:t.isSync,remark:t.remark},this.formModel.deadline&&(this.deadlineText=A()(this.formModel.deadline).format("YYYY-MM-DD HH:mm:ss"))),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),window.$sentry.log({error:e.t0,fileName:"/github/workspace/src/views/note/create/index.vue",lineNo:110,scope:"NoteCreate -> value -> _created"}),console.log(e.t0);case 12:this.validator=new G["a"]({rules:this.rules,data:this.formModel});case 13:case"end":return e.stop()}}),e,this,[[1,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"id",get:function(){return this.$route.params.id?parseInt(this.$route.params.id,10):void 0}},{key:"notebookId",get:function(){return parseInt(this.$route.query.notebookId,10)}},{key:"isEdit",get:function(){return"note.edit"===this.$route.name}}]),t}(J["c"]);U=Object(z["b"])([Object(J["a"])({components:{}})],U);var W=U,X=W,Z=(n("1d91"),n("2877")),ee=Object(Z["a"])(X,a,i,!1,null,"5a1ee580",null);t["default"]=ee.exports},e0da:function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,".note__create-form--metion[data-v-5a1ee580]{float:right;margin:4.267vw 4.267vw 0 0;font-size:3.2vw;color:#1989fa}",""])}}]);
//# sourceMappingURL=chunk-1e842cc9.515f2333.js.map